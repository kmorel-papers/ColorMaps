(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     53407,       1749]
NotebookOptionsPosition[     49662,       1621]
NotebookOutlinePosition[     50004,       1636]
CellTagsIndexPosition[     49961,       1633]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Color Space ",
 Cell[BoxData[
  FormBox["Conversions", TraditionalForm]]]
}], "Section"],

Cell[BoxData[
 RowBox[{"rgb2xyz", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"rgb", ",", 
    RowBox[{"100", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.4124", ",", "0.3576", ",", "0.1805"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2126", ",", "0.7152", ",", "0.0722"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0193", ",", "0.1192", ",", "0.9505"}], "}"}]}], "}"}], 
      ".", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", ">", "0.04045"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "+", "0.055"}], ")"}], "/", "1.055"}], ")"}], 
             "^", "2.4"}], ",", 
            RowBox[{"#", "/", "12.92"}]}], "]"}], ")"}], "&"}], ",", "rgb"}], 
       "]"}]}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyz2rgb", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", ">", "0.0031308"}], ",", 
          RowBox[{
           RowBox[{"1.055", 
            RowBox[{"(", 
             RowBox[{"#", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "2.4"}], ")"}]}], ")"}]}], "-", "0.055"}], 
          ",", 
          RowBox[{"12.92", "#"}]}], "]"}], ")"}], "&"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "100"}], ")"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3.2406254773200533`", ",", 
            RowBox[{"-", "1.5372079722103187`"}], ",", 
            RowBox[{"-", "0.49862859869824777`"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.9689307147293197`"}], ",", "1.8757560608852415`", 
            ",", "0.04151752384295395`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.05571012044551063`", ",", 
            RowBox[{"-", "0.20402105059848671`"}], ",", 
            "1.0569959422543882`"}], "}"}]}], "}"}], ".", "xyz"}]}]}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyz2lab", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "116", ",", "0", ",", 
         RowBox[{"-", "16"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"500", ",", 
         RowBox[{"-", "500"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "200", ",", 
         RowBox[{"-", "200"}], ",", "0"}], "}"}]}], "}"}], ".", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", ">", "0.008856"}], ",", 
             RowBox[{"#", "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "3"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"7.787", "#"}], "+", 
              RowBox[{"16", "/", "116"}]}]}], "]"}], ")"}], "&"}], ",", 
         RowBox[{"xyz", "/", 
          RowBox[{"{", 
           RowBox[{"95.047", ",", "100", ",", "108.883"}], "}"}]}]}], "]"}], 
       ",", "1"}], "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"lab2xyz", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"lab", ",", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "^", "3"}], ">", "0.008856"}], ",", 
           RowBox[{"#", "^", "3"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"16", "/", "116"}]}], ")"}], "/", "7.787"}]}], "]"}], 
         ")"}], "&"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "116"}], ",", 
              RowBox[{"1", "/", "500"}], ",", "0", ",", 
              RowBox[{"16", "/", "116"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "116"}], ",", "0", ",", "0", ",", 
              RowBox[{"16", "/", "116"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "116"}], ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "200"}], ",", 
              RowBox[{"16", "/", "116"}]}], "}"}]}], "}"}], ".", 
          RowBox[{"Append", "[", 
           RowBox[{"lab", ",", "1"}], "]"}]}], ")"}], "\[LeftDoubleBracket]", 
        
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], 
        "\[RightDoubleBracket]"}]}], "]"}], 
     RowBox[{"{", 
      RowBox[{"95.047", ",", "100", ",", "108.883"}], "}"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rgb2lab", "=", 
   RowBox[{"Composition", "[", 
    RowBox[{"xyz2lab", ",", "rgb2xyz"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lab2rgb", "=", 
   RowBox[{"Composition", "[", 
    RowBox[{"xyz2rgb", ",", "lab2xyz"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"lab2msh", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"lab", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"l", "^", "2"}], "+", 
         RowBox[{"a", "^", "2"}], "+", 
         RowBox[{"b", "^", "2"}]}], "]"}], ",", 
       RowBox[{"ArcCos", "[", 
        RowBox[{"l", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"l", "^", "2"}], "+", 
           RowBox[{"a", "^", "2"}], "+", 
           RowBox[{"b", "^", "2"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "\[NotEqual]", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{"b", "\[NotEqual]", "0"}], ")"}]}], ",", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", "0"}], "]"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "\[Rule]", 
        RowBox[{
        "lab", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"a", "\[Rule]", 
        RowBox[{
        "lab", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"b", "\[Rule]", 
        RowBox[{
        "lab", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
      "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"msh2lab", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"msh", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", " ", 
        RowBox[{"Cos", "[", "s", "]"}]}], ",", 
       RowBox[{"M", " ", 
        RowBox[{"Sin", "[", "s", "]"}], 
        RowBox[{"Cos", "[", "h", "]"}]}], ",", 
       RowBox[{"M", " ", 
        RowBox[{"Sin", "[", "s", "]"}], 
        RowBox[{"Sin", "[", "h", "]"}]}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "\[Rule]", 
        RowBox[{
        "msh", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"s", "\[Rule]", 
        RowBox[{
        "msh", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"h", "\[Rule]", 
        RowBox[{
        "msh", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
      "}"}]}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell["\<\
Approximations that are have errors when values in the triples are small.\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"rgb2xyzApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"rgb", ",", 
    RowBox[{"100", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.4124", ",", "0.3576", ",", "0.1805"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.2126", ",", "0.7152", ",", "0.0722"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0193", ",", "0.1192", ",", "0.9505"}], "}"}]}], "}"}], 
      ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"rgb", "+", "0.055"}], ")"}], "/", "1.055"}], ")"}], "^", 
        "2.4"}], ")"}]}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyz2rgbApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"1.055", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "100"}], ")"}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3.2406254773200533`", ",", 
                RowBox[{"-", "1.5372079722103187`"}], ",", 
                RowBox[{"-", "0.49862859869824777`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.9689307147293197`"}], ",", 
                "1.8757560608852415`", ",", "0.04151752384295395`"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"0.05571012044551063`", ",", 
                RowBox[{"-", "0.20402105059848671`"}], ",", 
                "1.0569959422543882`"}], "}"}]}], "}"}], ".", "xyz"}]}], 
          ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2.4"}], ")"}]}], ")"}]}], "-", "0.055"}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyz2labApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "116", ",", "0", ",", 
         RowBox[{"-", "16"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"500", ",", 
         RowBox[{"-", "500"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "200", ",", 
         RowBox[{"-", "200"}], ",", "0"}], "}"}]}], "}"}], ".", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"xyz", "/", 
          RowBox[{"{", 
           RowBox[{"95.047", ",", "100", ",", "108.883"}], "}"}]}], ")"}], 
        "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "3"}], ")"}]}], ",", "1"}], "]"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"lab2xyzApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"lab", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "116"}], ",", 
               RowBox[{"1", "/", "500"}], ",", "0", ",", 
               RowBox[{"16", "/", "116"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "116"}], ",", "0", ",", "0", ",", 
               RowBox[{"16", "/", "116"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "116"}], ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "200"}], ",", 
               RowBox[{"16", "/", "116"}]}], "}"}]}], "}"}], ".", 
           RowBox[{"Append", "[", 
            RowBox[{"lab", ",", "1"}], "]"}]}], ")"}], "\[LeftDoubleBracket]",
          
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}],
         ")"}], "^", "3"}], ")"}], 
     RowBox[{"{", 
      RowBox[{"95.047", ",", "100", ",", "108.883"}], "}"}]}]}], 
   "]"}]}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Determine if a particular color is representable on a standard rgb display.\
\>", "Section"],

Cell[BoxData[
 RowBox[{"rgbvalid", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"rgb", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r", "\[GreaterEqual]", "0"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"r", "\[LessEqual]", "1"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"g", "\[GreaterEqual]", "0"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"g", "\[LessEqual]", "1"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"b", "\[GreaterEqual]", "0"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"b", "\[LessEqual]", "1"}], ")"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "\[Rule]", 
        RowBox[{
        "rgb", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"g", "\[Rule]", 
        RowBox[{
        "rgb", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       
       RowBox[{"b", "\[Rule]", 
        RowBox[{
        "rgb", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
      "}"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyzvalid", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{"rgbvalid", "[", 
     RowBox[{"xyz2rgb", "[", "xyz", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"labvalid", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"lab", ",", 
    RowBox[{"xyzvalid", "[", 
     RowBox[{"lab2xyz", "[", "lab", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"xyzvalidApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"xyz", ",", 
    RowBox[{"rgbvalid", "[", 
     RowBox[{"xyz2rgbApprox", "[", "xyz", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"labvalidApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"lab", ",", 
    RowBox[{"xyzvalidApprox", "[", 
     RowBox[{"lab2xyzApprox", "[", "lab", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell["\<\
Given a particular a and b, what is the maximum L you can achieve on a \
typical display?\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"maxL", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"L", ",", 
         RowBox[{"labvalid", "[", 
          RowBox[{"{", 
           RowBox[{"L", ",", "a", ",", "b"}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", "L", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxL", "[", 
  RowBox[{"50", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NMaximize", "::", "\<\"incst\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(NMaximize\\) was unable to generate any initial \
points satisfying the inequality constraints \
\\!\\({\\(\\(\\(\\(\\(\\(-1\\)\\) + \\(\\(If[\\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) \[LessEqual] 0\\)\\), \\(\\(\\(\\(-\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\)\\) \[LessEqual] 0\\)\\), \\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\(\\(\\(\\(\\(-1\\)\\) + \
\\(\\(If[\\(\\(\\(\\(\\(\\(1\\/100\\\\ \
\\(\\((\\(\\(\\(\\(-208.01297493309318`\\)\\)\\\\ \\(\\(If[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \
\\(\\(308.0117297428391`\\\\ \\(\\(If[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\))\\)\\)\\)\\) > 0.0031308`\\)\\), \
\\(\\(\\(\\(1.055`\\\\ \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\)\\) - \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)\\)\\) \[LessEqual] 0\\)\\), \\(\\(\\(\\(-\
\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\)\\) \[LessEqual] \
0\\)\\)}\\). The initial region specified may not contain any feasible \
points. Changing the initial region or specifying explicit initial points may \
provide a better solution. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NMaximize/incst\\\", ButtonNote -> \
\\\"NMaximize::incst\\\"]\\)\"\>"}]], "Message",
 CellChangeTimes->{3.3974078454309435`*^9}],

Cell[BoxData["70.48392385767383`"], "Output",
 CellChangeTimes->{3.397407846288173*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"maxLApprox", ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{
     RowBox[{"NMaximize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"L", ",", 
         RowBox[{"labvalidApprox", "[", 
          RowBox[{"{", 
           RowBox[{"L", ",", "a", ",", "b"}], "}"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", "L", "}"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxLApprox", "[", 
  RowBox[{"50", ",", "0"}], "]"}]], "Input"],

Cell[BoxData["70.48392379591151`"], "Output",
 CellChangeTimes->{3.3974078466310654`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Brewer", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"brewer", "=", 
   RowBox[{"Reverse", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"178", ",", "24", ",", "43"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"214", ",", "96", ",", "77"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"244", ",", "165", ",", "130"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"253", ",", "219", ",", "199"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"247", ",", "247", ",", "247"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"209", ",", "229", ",", "240"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"146", ",", "197", ",", "222"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"67", ",", "147", ",", "195"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "102", ",", "172"}], "}"}]}], "}"}], "/", "255"}], 
    "]"}]}], "\n", "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["11", "85"], ",", 
     FractionBox["2", "5"], ",", 
     FractionBox["172", "255"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["67", "255"], ",", 
     FractionBox["49", "85"], ",", 
     FractionBox["13", "17"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["146", "255"], ",", 
     FractionBox["197", "255"], ",", 
     FractionBox["74", "85"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["209", "255"], ",", 
     FractionBox["229", "255"], ",", 
     FractionBox["16", "17"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["247", "255"], ",", 
     FractionBox["247", "255"], ",", 
     FractionBox["247", "255"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["253", "255"], ",", 
     FractionBox["73", "85"], ",", 
     FractionBox["199", "255"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["244", "255"], ",", 
     FractionBox["11", "17"], ",", 
     FractionBox["26", "51"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["214", "255"], ",", 
     FractionBox["32", "85"], ",", 
     FractionBox["77", "255"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["178", "255"], ",", 
     FractionBox["8", "85"], ",", 
     FractionBox["43", "255"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3973969870661373`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xyz2lab", "[", 
  RowBox[{"rgb2xyz", "[", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["247", "255"], ",", 
     FractionBox["247", "255"], ",", 
     FractionBox["247", "255"]}], "}"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"97.23209971720574`", ",", "0.005134978067533602`", ",", 
   RowBox[{"-", "0.010159832655531886`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3973969871286383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"maxL", "[", 
  RowBox[{"0.0051349780675309376`", ",", 
   RowBox[{"-", "0.010159832655517675`"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"maxL", "[", 
  RowBox[{"0.0051349780675309376`", ",", 
   RowBox[{"-", "0.010159832655517675`"}]}], "]"}]], "Output",
 CellChangeTimes->{3.3973969871598883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"xyz2lab", "[", 
         RowBox[{"rgb2xyz", "[", "#", "]"}], "]"}], "\[LeftDoubleBracket]", 
        "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"xyz2lab", "[", 
         RowBox[{"rgb2xyz", "[", "#", "]"}], "]"}], "\[LeftDoubleBracket]", 
        "2", "\[RightDoubleBracket]"}]}], "}"}], ")"}], "&"}], ",", 
   "brewer"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"42.46738923105588`", ",", "4.439261076447709`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58.037865389656986`", ",", 
     RowBox[{"-", "9.373327781951268`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"76.8708891509288`", ",", 
     RowBox[{"-", "10.592876988394229`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"89.80601456442777`", ",", 
     RowBox[{"-", "4.43675640913005`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"97.23209971720574`", ",", "0.005134978067533602`"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"89.7055306028219`", ",", "8.756805591339123`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"74.67018104580366`", ",", "25.312370703777287`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"55.27540061018943`", ",", "45.09935478685401`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"38.362644999432135`", ",", "58.66019355747287`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.3973969871755133`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"xyz2lab", "[", 
          RowBox[{"rgb2xyz", "[", "#1", "]"}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}], "&"}], ")"}], "/@", "brewer"}], ",", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"xyz2lab", "[", 
          RowBox[{"rgb2xyz", "[", "#1", "]"}], "]"}], "\[LeftDoubleBracket]", 
         "2", "\[RightDoubleBracket]"}], "&"}], ")"}], "/@", "brewer"}], ",", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"xyz2lab", "[", 
          RowBox[{"rgb2xyz", "[", "#1", "]"}], "]"}], "\[LeftDoubleBracket]", 
         "3", "\[RightDoubleBracket]"}], "&"}], ")"}], "/@", "brewer"}], ",", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"maxL", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"xyz2lab", "[", 
            RowBox[{"rgb2xyz", "[", "#1", "]"}], "]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"xyz2lab", "[", 
            RowBox[{"rgb2xyz", "[", "#1", "]"}], "]"}], 
           "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], 
        "&"}], ")"}], "/@", "brewer"}]}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input"],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], 
    LineBox[{{1., 42.46738923105588}, {2., 58.037865389656986`}, {3., 
     76.8708891509288}, {4., 89.80601456442777}, {5., 97.23209971720574}, {6.,
      89.7055306028219}, {7., 74.67018104580366}, {8., 55.27540061018943}, {
     9., 38.362644999432135`}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    LineBox[{{1., 4.439261076447709}, {2., -9.373327781951268}, {
     3., -10.592876988394229`}, {4., -4.43675640913005}, {5., 
     0.005134978067533602}, {6., 8.756805591339123}, {7., 
     25.312370703777287`}, {8., 45.09935478685401}, {9., 
     58.66019355747287}}]}, 
   {Hue[0.14213595499957954`, 0.6, 0.6], 
    LineBox[{{1., -43.41227626290733}, {2., -32.06986524606366}, {
     3., -17.786001926380667`}, {4., -7.603115875695954}, {
     5., -0.010159832655531886`}, {6., 14.173194031106684`}, {7., 
     29.984836969005624`}, {8., 33.423518023084995`}, {9., 
     31.597944201026873`}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  PlotRange->{{0., 9.}, {-43.41227626290733, 97.23209971720574}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{3.397396987269264*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding a hue spin", "Section"],

Cell["\<\
Ideally, we would use the Msh space to hold M and h constant and then swing s \
from some value to 0.  However, the swing causes the vector to leave the \
gamut of displayable colors unless M is lowered to the point where the colors \
are no longer vibrant.  To counter this, we will also linearly change M.  One \
consequence of this is that the colors change more \"quickly\" when M is \
larger.  We can largely correct this problem by also changing hue.  The hue \
will cause a bigger change when there is more saturation (and where we are \
defining M to be smaller).  This section determines a good value for the \
ending h given a starting M, s, and h and an ending M (with the ending s \
assumed to be 0).  The function is defined in the range 0-1/2, since it will \
cover half of the domain of a full divergent color map.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmsh", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"M2", "-", "M1"}], ")"}], "x"}], "+", "M1"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "x"}]}], ")"}], "s1"}], ",", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"h2", "-", "h1"}], ")"}], "x"}], "+", "h1"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"M1", "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ",", 
   RowBox[{"s1", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "x"}]}], ")"}]}], ",", 
   RowBox[{"h1", "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.3973970562384553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"clab", "=", 
  RowBox[{"msh2lab", "[", "cmsh", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"s1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"h1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"s1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"M1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"s1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"h1", "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.397397056285331*^9}]
}, Open  ]],

Cell["\<\
The perceptual rate of change of a color map (with respect to changes in the \
scalar value) is given by the magnitude of the piecewise derivative of the \
function in CIELAB space.  (I show this in my lab journal on 8/7/2007.)  The \
following resolves this perceptual rate of change given the linearly changing \
M, s, and h values defined above.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"color", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Derivative", "[", "1", "]"}], "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"color", "/.", 
            RowBox[{"x", "\[Rule]", "#"}]}], "]"}], ")"}], "&"}], "]"}], 
       ")"}], "[", "x", "]"}]}], "]"}], ",", "clab"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "s1", " ", 
     RowBox[{"(", 
      RowBox[{"M1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "s1", " ", 
     RowBox[{"(", 
      RowBox[{"M1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}], "+",
     
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"M1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"M1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "s1", " ", 
     RowBox[{"(", 
      RowBox[{"M1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}], "+",
     
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"h1", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.397397056316581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sqrt", "[", 
  RowBox[{"%", ".", "%"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[Sqrt]", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{"M1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{"M1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}], 
       "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}]}],
       ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{"M1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], 
        " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}], 
       "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"M1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M1"}], "+", "M2"}], ")"}], " ", "x"}]}], ")"}], 
        " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "x"}]}], ")"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"h1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "h1"}], "+", "h2"}], ")"}], " ", "x"}]}], "]"}]}]}],
       ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.3973970563478312`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["M1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h1", "2"], " ", 
      SuperscriptBox["M1", "2"]}], "-", 
     RowBox[{"2", " ", "h1", " ", "h2", " ", 
      SuperscriptBox["M1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h2", "2"], " ", 
      SuperscriptBox["M1", "2"]}], "-", 
     RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["M2", "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["M1", "2"], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"4", " ", "M1", " ", 
      RowBox[{"(", 
       RowBox[{"M1", "-", "M2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"h1", "-", "h2"}], ")"}], "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}], " ", "x"}], "+", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"M1", "-", "M2"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"h1", "-", "h2"}], ")"}], "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}], " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"h1", "-", "h2"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"M1", "-", 
         RowBox[{"2", " ", "M1", " ", "x"}], "+", 
         RowBox[{"2", " ", "M2", " ", "x"}]}], ")"}], "2"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"s1", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"4", " ", "x"}]}], ")"}]}], "]"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.397397737305314*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cdmag", "=", "%"}], ";"}]], "Input"],

Cell["\<\
We want the perceptual rate of change to be constant.  That is not really \
possible, but we can get mighty close by adjusting h2 such that the rate of \
change is equal at the doman extrema (x = 0 and x = 1/2).  At x = 1/2, the \
hue values should drop out of the equation because a change in hue has no \
effect when saturation is 0.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cdmag", "/.", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{"1", "/", "2"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  SqrtBox["2"], " ", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["M1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h1", "2"], " ", 
      SuperscriptBox["M1", "2"]}], "-", 
     RowBox[{"2", " ", "h1", " ", "h2", " ", 
      SuperscriptBox["M1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h2", "2"], " ", 
      SuperscriptBox["M1", "2"]}], "-", 
     RowBox[{"4", " ", "M1", " ", "M2"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["M2", "2"]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"h1", "-", "h2"}], ")"}], "2"], " ", 
      SuperscriptBox["M2", "2"]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["M1", "2"], " ", 
      SuperscriptBox["s1", "2"]}], "-", 
     RowBox[{"2", " ", "M1", " ", 
      RowBox[{"(", 
       RowBox[{"M1", "-", "M2"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"h1", "-", "h2"}], ")"}], "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"M1", "-", "M2"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"h1", "-", "h2"}], ")"}], "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["s1", "2"]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.3973977373678145`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"2", " ", 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"M1", "-", "M2"}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox["M2", "2"], " ", 
     SuperscriptBox["s1", "2"]}]}]]}]], "Output",
 CellChangeTimes->{3.3973977374771905`*^9}]
}, Open  ]],

Cell["\<\
Now that we know the perceptual rate of change at x = 1/2, find it at x = 0 \
and build an equation with it.  Then solve.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "cdmag"}], "/.", 
   RowBox[{"x", "\[Rule]", "0"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["M1", "2"]}], "+", 
      SuperscriptBox["M2", "2"]}], ")"}], " ", 
    SuperscriptBox["s1", "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"h1", "-", "h2"}], ")"}], "2"], " ", 
    SuperscriptBox["M1", "2"], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "s1"}], "]"}]}]}], "\[Equal]", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"h1", "-", "h2"}], ")"}], "2"], " ", 
   SuperscriptBox["M1", "2"]}]}]], "Output",
 CellChangeTimes->{3.3973977382584453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"%", ",", "h2"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "h1"}], " ", 
        SuperscriptBox["M1", "2"]}], "+", 
       RowBox[{"h1", " ", 
        SuperscriptBox["M1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s1"}], "]"}]}], "-", 
       RowBox[{
        SqrtBox["2"], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["M1", "4"]}], " ", 
           SuperscriptBox["s1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["M1", "2"], " ", 
           SuperscriptBox["M2", "2"], " ", 
           SuperscriptBox["s1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["M1", "4"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "s1"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["M1", "2"], " ", 
           SuperscriptBox["M2", "2"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "s1"}], "]"}]}]}]]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["M1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["M1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s1"}], "]"}]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "h1"}], " ", 
        SuperscriptBox["M1", "2"]}], "+", 
       RowBox[{"h1", " ", 
        SuperscriptBox["M1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s1"}], "]"}]}], "+", 
       RowBox[{
        SqrtBox["2"], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["M1", "4"]}], " ", 
           SuperscriptBox["s1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["M1", "2"], " ", 
           SuperscriptBox["M2", "2"], " ", 
           SuperscriptBox["s1", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["M1", "4"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "s1"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["M1", "2"], " ", 
           SuperscriptBox["M2", "2"], " ", 
           SuperscriptBox["s1", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "s1"}], "]"}]}]}]]}]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["M1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["M1", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "s1"}], "]"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.3973977383209457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h2", "\[Rule]", 
     RowBox[{"h1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Csc", "[", "s1", "]"}], "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["M1", "2"]}], "+", 
            SuperscriptBox["M2", "2"]}], ")"}], " ", 
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s1", "]"}], "2"]}]]}], 
       SuperscriptBox["M1", "2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h2", "\[Rule]", 
     RowBox[{"h1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Csc", "[", "s1", "]"}], "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["M1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["M1", "2"]}], "+", 
            SuperscriptBox["M2", "2"]}], ")"}], " ", 
          SuperscriptBox["s1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "s1", "]"}], "2"]}]]}], 
       SuperscriptBox["M1", "2"]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.397397740383459*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " is being conservative here.  If we use some of our domain knowledge, we \
can resolve h2 to be h1 +/- the following "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s1", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"M2", "^", "2"}], "-", 
     RowBox[{"M1", "^", "2"}]}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Sin", "[", "s1", "]"}], "M1"}], ")"}]}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["M1", "2"]}], "+", 
     SuperscriptBox["M2", "2"]}]], " ", "s1", " ", 
   RowBox[{"Csc", "[", "s1", "]"}]}], "M1"]], "Output",
 CellChangeTimes->{3.397397740430334*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{760, 730},
WindowMargins->{{Automatic, 711}, {Automatic, 92}},
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (June 19, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[590, 23, 106, 4, 71, "Section"],
Cell[699, 29, 969, 29, 92, "Input"],
Cell[1671, 60, 1295, 37, 112, "Input"],
Cell[2969, 99, 1164, 34, 92, "Input"],
Cell[4136, 135, 1618, 47, 112, "Input"],
Cell[5757, 184, 149, 4, 31, "Input"],
Cell[5909, 190, 149, 4, 31, "Input"],
Cell[6061, 196, 1374, 41, 92, "Input"],
Cell[7438, 239, 920, 28, 72, "Input"],
Cell[CellGroupData[{
Cell[8383, 271, 103, 2, 36, "Subsection"],
Cell[8489, 275, 693, 21, 92, "Input"],
Cell[9185, 298, 1168, 32, 172, "Input"],
Cell[10356, 332, 838, 26, 72, "Input"],
Cell[11197, 360, 1286, 36, 92, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12532, 402, 102, 2, 71, "Section"],
Cell[12637, 406, 1099, 32, 72, "Input"],
Cell[13739, 440, 194, 5, 31, "Input"],
Cell[13936, 447, 194, 5, 31, "Input"],
Cell[14133, 454, 206, 5, 31, "Input"],
Cell[14342, 461, 212, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[14579, 470, 119, 3, 36, "Subsection"],
Cell[14701, 475, 504, 15, 31, "Input"],
Cell[CellGroupData[{
Cell[15230, 494, 81, 2, 31, "Input"],
Cell[15314, 498, 1553, 25, 132, "Message"],
Cell[16870, 525, 87, 1, 30, "Output"]
}, Open  ]],
Cell[16972, 529, 516, 15, 31, "Input"],
Cell[CellGroupData[{
Cell[17513, 548, 87, 2, 31, "Input"],
Cell[17603, 552, 89, 1, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17753, 560, 25, 0, 71, "Section"],
Cell[CellGroupData[{
Cell[17803, 564, 920, 25, 112, "Input"],
Cell[18726, 591, 1446, 48, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20209, 644, 237, 7, 45, "Input"],
Cell[20449, 653, 203, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20689, 662, 140, 3, 31, "Input"],
Cell[20832, 667, 185, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21054, 676, 509, 15, 31, "Input"],
Cell[21566, 693, 1008, 26, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22611, 724, 1464, 43, 72, "Input"],
Cell[24078, 769, 1270, 27, 236, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25397, 802, 37, 0, 71, "Section"],
Cell[25437, 804, 853, 12, 119, "Text"],
Cell[CellGroupData[{
Cell[26315, 820, 428, 16, 31, "Input"],
Cell[26746, 838, 509, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27292, 861, 89, 2, 31, "Input"],
Cell[27384, 865, 1528, 52, 50, "Output"]
}, Open  ]],
Cell[28927, 920, 372, 6, 65, "Text"],
Cell[CellGroupData[{
Cell[29324, 930, 462, 14, 31, "Input"],
Cell[29789, 946, 4233, 140, 145, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34059, 1091, 80, 2, 31, "Input"],
Cell[34142, 1095, 4891, 154, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39070, 1254, 65, 1, 31, "Input"],
Cell[39138, 1257, 1893, 59, 77, "Output"]
}, Open  ]],
Cell[41046, 1319, 71, 2, 31, "Input"],
Cell[41120, 1323, 359, 6, 65, "Text"],
Cell[CellGroupData[{
Cell[41504, 1333, 107, 3, 31, "Input"],
Cell[41614, 1338, 1523, 48, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43174, 1391, 65, 1, 31, "Input"],
Cell[43242, 1394, 292, 10, 39, "Output"]
}, Open  ]],
Cell[43549, 1407, 145, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[43719, 1414, 154, 4, 31, "Input"],
Cell[43876, 1420, 645, 22, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44558, 1447, 82, 2, 31, "Input"],
Cell[44643, 1451, 2791, 85, 163, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47471, 1541, 65, 1, 31, "Input"],
Cell[47539, 1544, 1319, 41, 105, "Output"]
}, Open  ]],
Cell[48873, 1588, 197, 5, 29, "Text"],
Cell[CellGroupData[{
Cell[49095, 1597, 263, 9, 31, "Input"],
Cell[49361, 1608, 273, 9, 55, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
